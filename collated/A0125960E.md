# A0125960E
###### src\app\constants\StorageConstants.java
``` java
public class StorageConstants {
	// file locations
	public static final String FILE_CONFIGURATION = "config.properties";
	public static final String FILE_DEFAULT_STORAGE = "next.txt";
	public static final String FILE_DEFAULT_LOG = "logs/next.log";

	// configuration file properties
	public static final String PROPERTIES_STORAGE_FILE_LOCATION = "storageFileLocation";
	public static final String PROPERTIES_LOG_FILE_LOCATION = "logFileLocation";
	public static final String PROPERTIES_SELECTED_THEME = "selectedTheme";
	
	// index of observers in the observer list
	public static final int OBSERVER_INDEX_STORAGE = 0;
	public static final int OBSERVER_INDEX_LOG = 1;

	// error messages
	public static final String ERROR_INITIALIZE_TASKSTORAGE = "IOException while initializing TaskStorage";
	public static final String ERROR_WRITE_PROPERTIES = "IOException while writing properties to configuration file";
	public static final String ERROR_WRITE_TASKS = "IOException while writing tasks to storage file";
	public static final String ERROR_READ_PROPERTIES = "IOException while reading properties from configuration file";
	public static final String ERROR_READ_TASKS = "IOException while reading tasks from storage file";
	public static final String ERROR_TO_CANONICAL_PATH = "IOException while converting path to canonical";
	
	// logging messages
	public static final String LOG_USER_INPUT = "User pressed enter key with input: %1$s";
	public static final String LOG_INITIALIZE_VIEW = "Initializing view: %1$s";
	public static final String LOG_EXECUTE_COMMAND = "Executing %1$s object";
}
```
###### src\app\constants\ViewConstants.java
``` java
	// SAVE command
	public static final String SAVE_STORAGE = "storage";
	public static final String SAVE_LOG = "log";
	public static final String SAVE_DEFAULT = "default";
	public static final String MESSAGE_SAVE = "Saved %1$s file location: %2$s";
	public static final String ERROR_SAVE = "Error saving file location: %1$s";
	public static final String ERROR_SAVE_NO_LOCATION = "No %1$s file location specified";
	public static final String ERROR_SAVE_NO_CHANGES = "Same %1$s file location. No changes to %1$s file location: %2$s";
	public static final String ERROR_SAVE_COPY_FILE = "IOException while copying %1$s file to specified location: %2$s";
	public static final String ERROR_SAVE_DELETE_FILE = "IOException while deleting previous %1$s file: %2$s";
	public static final String ERROR_SAVE_FILE_ALREADY_EXISTS = "File already exists in specified location: %1$s";

```
###### src\app\logic\command\CommandSave.java
``` java
public class CommandSave extends Command {
	private boolean isLog;
	private String prevFileLocation;

	/* Constructor */
	public CommandSave() {
		super();
		this.setCommandType(CommandType.SAVE);
	}

	/* Mutator */
	public void setLog(boolean hasLogKeyword) {
		isLog = hasLogKeyword;
	}

	/**
	 * Executes the save command. If successful, it moves the storage/log file to the
	 * new location and updates the configuration file.
	 * 
	 * @param previousViewState	Previous view state.
	 * @return					New view state.
	 */
	@Override
	public ViewState execute(ViewState previousViewState) {
		LogHelper.getInstance().getLogger().info(String.format(StorageConstants.LOG_EXECUTE_COMMAND, "CommandSave"));
		ViewState viewState = new ViewState();

		try {
			if (this.getContent().isEmpty()) {
				String errorMsg = String.format(ViewConstants.ERROR_SAVE_NO_LOCATION,
						(isLog) ? ViewConstants.SAVE_LOG : ViewConstants.SAVE_STORAGE);
				viewState.setStatus(StatusType.ERROR, errorMsg);
				LogHelper.getInstance().getLogger().info(errorMsg);

				return viewState;
			}

			prevFileLocation = (isLog) ? AppStorage.getInstance().getLogFileLocation()
					: AppStorage.getInstance().getStorageFileLocation();

			String errorMsg = changeFileLocation(prevFileLocation, this.getContent());

			if (errorMsg == null) {
				String successMsg = String.format(ViewConstants.MESSAGE_SAVE,
						(isLog) ? ViewConstants.SAVE_LOG : ViewConstants.SAVE_STORAGE,
								(isLog) ? AppStorage.getInstance().getLogFileLocation()
										: AppStorage.getInstance().getStorageFileLocation());
				viewState.setStatus(successMsg);
				LogHelper.getInstance().getLogger().info(successMsg);
				setExecuted(true);
			} else {
				viewState.setStatus(StatusType.ERROR, errorMsg);
				LogHelper.getInstance().getLogger().info(errorMsg);
			}
		} catch (Exception e) {
			viewState.setStatus(StatusType.ERROR, String.format(ViewConstants.ERROR_SAVE, this.getContent()));
			LogHelper.getInstance().getLogger().severe(e.getMessage());
		}

		return viewState;
	}

	/**
	 * Undo the save command. If successful, it moves the storage/log file to the
	 * previous location and updates the configuration file.
	 * 
	 * @return	Previous view state.
	 */
	@Override
	public ViewState undo() {
		if (!isExecuted()) {
			return new ViewState();
		}

		ViewState viewState = new ViewState();

		try {
			String errorMsg = changeFileLocation(this.getContent(), prevFileLocation);

			if (errorMsg == null) {
				String successMsg = String.format(ViewConstants.MESSAGE_SAVE,
						(isLog) ? ViewConstants.SAVE_LOG : ViewConstants.SAVE_STORAGE,
								(isLog) ? AppStorage.getInstance().getLogFileLocation()
										: AppStorage.getInstance().getStorageFileLocation());
				viewState.setStatus(ViewConstants.MESSAGE_UNDO + successMsg);
				LogHelper.getInstance().getLogger().info(ViewConstants.MESSAGE_UNDO + successMsg);
				setExecuted(false);
			} else {
				viewState.setStatus(StatusType.ERROR, ViewConstants.ERROR_UNDO + errorMsg);
				LogHelper.getInstance().getLogger().info(ViewConstants.ERROR_UNDO + errorMsg);
			}
		} catch (Exception e) {
			viewState.setStatus(StatusType.ERROR, String.format(ViewConstants.ERROR_UNDO + ViewConstants.ERROR_SAVE, this.getContent()));
			LogHelper.getInstance().getLogger().severe(e.getMessage());
		}

		return viewState;
	}

	/**
	 * Change the storage/log file location in the configuration file after
	 * successfully copying the storage/log file to the new file location and deleting
	 * the previous storage/log file.
	 * 
	 * @param prevPath 	Previous storage/log file location.
	 * @param newPath 	New storage/log file location.
	 * @return 			Error messages encountered when copying the file.
	 */
	private String changeFileLocation(String prevPath, String newPath) {
		String errorMsg;

		if (newPath.equalsIgnoreCase(ViewConstants.SAVE_DEFAULT)) {
			if (isLog) {
				errorMsg = copyFile(prevPath, StorageConstants.FILE_DEFAULT_LOG);

				if (errorMsg == null) {
					AppStorage.getInstance().setToDefaultLogFileLocation();
				}
			} else {
				errorMsg = copyFile(prevPath, StorageConstants.FILE_DEFAULT_STORAGE);

				if (errorMsg == null) {
					AppStorage.getInstance().setToDefaultStorageFileLocation();
				}
			}
		} else {
			errorMsg = copyFile(prevPath, newPath);

			if (errorMsg == null) {
				if (isLog) {
					AppStorage.getInstance().setLogFileLocation(newPath);
				} else {
					AppStorage.getInstance().setStorageFileLocation(newPath);
				}
			}
		}

		if (errorMsg == null) {
			File prevFile = new File(prevPath);

			try {
				removeFileAndParentsIfEmpty(prevFile.toPath());
			} catch (IOException e) {
				errorMsg = String.format(ViewConstants.ERROR_SAVE_DELETE_FILE,
						(isLog) ? ViewConstants.SAVE_LOG : ViewConstants.SAVE_STORAGE, prevPath);
			}
		}

		return errorMsg;
	}

	/**
	 * Copy a file from source to destination.
	 * 
	 * @param sourcePath 	Source file path.
	 * @param destPath 		Destination file path.
	 * @return 				Error messages that occurred when copying the file.
	 * 						Returns null if it successfully copied the file.
	 */
	private String copyFile(String sourcePath, String destPath) {
		String errorMsg = null;
		File sourceFile = new File(sourcePath);
		File destFile = new File(AppStorage.getInstance().toAcceptableCanonicalPath(destPath));

		if (destFile.getParentFile() != null) {
			destFile.getParentFile().mkdirs();
		}

		try {
			if (destFile.exists() && Files.isSameFile(sourceFile.toPath(), destFile.toPath())) {
				errorMsg = String.format(ViewConstants.ERROR_SAVE_NO_CHANGES,
						(isLog) ? ViewConstants.SAVE_LOG : ViewConstants.SAVE_STORAGE, sourcePath);
			} else {
				Files.copy(sourceFile.toPath(), destFile.toPath());
			}
		} catch (FileAlreadyExistsException e) {
			errorMsg = String.format(ViewConstants.ERROR_SAVE_FILE_ALREADY_EXISTS, this.getContent());
		} catch (IOException e) {
			errorMsg = String.format(ViewConstants.ERROR_SAVE_COPY_FILE,
					(isLog) ? ViewConstants.SAVE_LOG : ViewConstants.SAVE_STORAGE, this.getContent());
		}

		return errorMsg;
	}

	/**
	 * Removes specified file if exist and empty parent directories.
	 *  
	 * @param path			Path of specified file.
	 * @throws IOException
	 */
```
###### src\app\logic\CommandController.java
``` java
	private CommandController() {
		masterTaskList = TaskStorage.getInstance().readTasks();
		executedCommands = new Stack<Command>();
		commandHistory = new CommandList();
		initializeViewState();
	}
	

	private void initializeViewState() {
		currentViewState = new ViewState();
		currentViewState.setTaskList(masterTaskList.getTaskListByCompletion(false));
		currentViewState.getTaskList().sort();
		currentViewState.setHeader(String.format(ViewConstants.HEADER_DISPLAY,
				DisplayType.UNCOMPLETED.toString()));

		if (!(AppStorage.getInstance().getSelectedTheme().equalsIgnoreCase(ViewConstants.THEME_LIGHT)
				|| AppStorage.getInstance().getSelectedTheme().equalsIgnoreCase(ViewConstants.THEME_DARK))) {
			AppStorage.getInstance().setToDefaultSelectedTheme();
		}
		
		if (AppStorage.getInstance().getSelectedTheme().equalsIgnoreCase(ViewConstants.THEME_LIGHT)) {
			currentViewState.setTheme(ViewConstants.THEME_LIGHT_CSS);
		} else if (AppStorage.getInstance().getSelectedTheme().equalsIgnoreCase(ViewConstants.THEME_DARK)) {
			currentViewState.setTheme(ViewConstants.THEME_DARK_CSS);
		}
	}

```
###### src\app\model\TaskList.java
``` java
	public TaskList(ArrayList<Task> list) {
		taskList = FXCollections.observableArrayList(list);
	}

```
###### src\app\parser\CommandParser.java
``` java
	/**
	 * Parses and sets save-related parameters for the Command object
	 * specified. This method should only be used for the save command.
	 * 
	 * The following parameters are set:
	 * 
	 * - Content and isLog.
	 * 
	 * @param cmd The Command object to set parameters for
	 */
	public static void parseSave(Command cmd) {
		boolean hasLogKeyword = Common.getFirstWord(cmd.getContent()).equalsIgnoreCase(SAVE_LOG);
		CommandSave cmdSave = (CommandSave)cmd;
		cmdSave.setLog(hasLogKeyword);

		if (hasLogKeyword) {
			cmdSave.setContent(Common.removeFirstWord(cmdSave.getContent()));
		}
	}

```
###### src\app\storage\AppStorage.java
``` java
public class AppStorage {
	private static AppStorage appStorage;

	private File configFile;
	private Properties properties;
	private ArrayList<Observer> observerList;

	/**
	 * Initializes AppStorage.
	 */
	private AppStorage() {
		configFile = new File(StorageConstants.FILE_CONFIGURATION);
		properties = new Properties();
		observerList = new ArrayList<Observer>();

		try {
			if (!configFile.exists()) {
				configFile.createNewFile();

				setToDefaultStorageFileLocation();
				setToDefaultLogFileLocation();
				setToDefaultSelectedTheme();
			} else {
				readProperties();
			}
		} catch (IOException e) {
			e.printStackTrace();
		}
	}

	/**
	 * @return AppStorage instance.
	 */
	public static AppStorage getInstance() {
		if (appStorage == null) {
			appStorage = new AppStorage();
			appStorage.addObservers();
		}

		return appStorage;
	}

	/* Accessors and mutators */
	public String getStorageFileLocation() {
		return properties.getProperty(StorageConstants.PROPERTIES_STORAGE_FILE_LOCATION);
	}

	public void setStorageFileLocation(String path) {
		properties.setProperty(StorageConstants.PROPERTIES_STORAGE_FILE_LOCATION,
							   toAcceptableCanonicalPath(path));
		writeProperties();

		if (!observerList.isEmpty()) {
			notifyObserver(StorageConstants.OBSERVER_INDEX_STORAGE);
		}
	}

	public void setToDefaultStorageFileLocation() {
		setStorageFileLocation(StorageConstants.FILE_DEFAULT_STORAGE);
	}

	public String getLogFileLocation() {
		return properties.getProperty(StorageConstants.PROPERTIES_LOG_FILE_LOCATION);
	}

	public void setLogFileLocation(String path) {
		properties.setProperty(StorageConstants.PROPERTIES_LOG_FILE_LOCATION,
							   toAcceptableCanonicalPath(path));
		writeProperties();

		if (!observerList.isEmpty()) {
			notifyObserver(StorageConstants.OBSERVER_INDEX_LOG);
		}
	}

	public void setToDefaultLogFileLocation() {
		setLogFileLocation(StorageConstants.FILE_DEFAULT_LOG);
	}

	public String getSelectedTheme() {
		return properties.getProperty(StorageConstants.PROPERTIES_SELECTED_THEME);
	}

	public void setSelectedTheme(String theme) {
		assert(theme.equalsIgnoreCase(ViewConstants.THEME_LIGHT) || theme.equalsIgnoreCase(ViewConstants.THEME_DARK));

		properties.setProperty(StorageConstants.PROPERTIES_SELECTED_THEME, theme);
		writeProperties();
	}

	public void setToDefaultSelectedTheme() {
		setSelectedTheme(ViewConstants.THEME_LIGHT);
	}

	/**
	 * Write properties to the configuration file.
	 */
	private void writeProperties() {
		try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(configFile))) {
			bufferedWriter.write(StorageConstants.PROPERTIES_STORAGE_FILE_LOCATION + "="
								 + getStorageFileLocation());
			bufferedWriter.newLine();
			bufferedWriter.write(StorageConstants.PROPERTIES_LOG_FILE_LOCATION + "="
								 + getLogFileLocation());
			bufferedWriter.newLine();
			bufferedWriter.write(StorageConstants.PROPERTIES_SELECTED_THEME + "="
								 + getSelectedTheme());
		} catch (IOException e) {
			LogHelper.getInstance().getLogger().severe(StorageConstants.ERROR_WRITE_PROPERTIES);
		}
	}

	/**
	 * Read properties from the configuration file. If the selected theme is invalid, the
	 * selected theme will be set to default.
	 */
	private void readProperties() {
		try (BufferedReader bufferedReader = new BufferedReader(new FileReader(configFile))) {
			properties.load(bufferedReader);
		} catch (IOException e) {
			LogHelper.getInstance().getLogger().severe(StorageConstants.ERROR_READ_PROPERTIES);
		}
	}

	/**
	 * Converts the path into a canonical path.
	 * 
	 * @param path	File path.
	 * @return		Canonical path of the given path.
	 */
	private String toCanonicalPath(String path) {
		File file = new File(path);
		String canonicalPath = path;

		try {
			canonicalPath = file.getCanonicalPath();
		} catch (IOException e) {
			LogHelper.getInstance().getLogger().severe(StorageConstants.ERROR_TO_CANONICAL_PATH);
		}

		return canonicalPath;
	}

	/**
	 * Convert path to an acceptable canonical path by removing whitespace before slashes
	 * and replace backslashes to forward slashes. This is used to avoid using escape
	 * characters in the configuration file.
	 * 
	 * Note: The path returned may not be valid since the file system does not allow
	 * certain characters and combinations.
	 * 
	 * @param path 			File path.
	 * @return 				File path with backslash replaced with forward
	 * 						slash and removed whitespace before slash.
	 */
	public String toAcceptableCanonicalPath(String path) {
		String validPath = toCanonicalPath(path).replace("\\", "/").replaceAll("\\s*/\\s*", "/");

		return validPath;
	}

	/**
	 * Add the TaskStorage and LogHelper instances to the observerList.
	 */
	private void addObservers() {
		observerList.add(TaskStorage.getInstance());
		observerList.add(LogHelper.getInstance());
	}

	/**
	 * Updates the observer in the observerList at the specified index.
	 * 
	 * @param i	Index of the observer in the observerList.
	 */
	private void notifyObserver(int i) {
		observerList.get(i).update();
	}
}
```
###### src\app\storage\TaskStorage.java
``` java
public class TaskStorage implements Observer {
	private static TaskStorage taskStorage;

	private File storageFile;
	private Gson gson;

	/**
	 * Initializes TaskStorage.
	 */
	private TaskStorage() {
		gson = new GsonBuilder().setPrettyPrinting().create();

		update();

		if (!storageFile.exists()) {
			if (storageFile.getParentFile() != null) {
				storageFile.getParentFile().mkdirs();
			}

			try {
				storageFile.createNewFile();
			} catch (IOException e) {
				LogHelper.getInstance().getLogger().severe(StorageConstants.ERROR_INITIALIZE_TASKSTORAGE);
			}

			writeTasks(new TaskList());
		}
	}

```
###### src\app\storage\TaskStorage.java
``` java
	/**
	 * Write tasks in JSON strings to the storage file.
	 * 
	 * @param taskList	List of tasks to be stored.
	 */
	public void writeTasks(TaskList taskList) {
		try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(storageFile))) {
			gson.toJson(taskList.getTaskList(), bufferedWriter);
		} catch (IOException e) {
			LogHelper.getInstance().getLogger().severe(StorageConstants.ERROR_WRITE_TASKS);
		}
	}

	/**
	 * Read tasks from the storage file.
	 * 
	 * @return	TaskList of the stored tasks.
	 */
	public TaskList readTasks() {
		TaskList taskList = null;

		try (BufferedReader bufferedReader = new BufferedReader(new FileReader(storageFile))) {
			Type type = new TypeToken<ArrayList<Task>>(){}.getType();
			ArrayList<Task> arrayList = gson.fromJson(bufferedReader, type);
			taskList = new TaskList(arrayList);
		} catch (IOException e) {
			LogHelper.getInstance().getLogger().severe(StorageConstants.ERROR_READ_TASKS);
			taskList = new TaskList();
		}

		return taskList;
	}

	/**
	 * Updates the storage file location.
	 */
	@Override
	public void update() {
		storageFile = new File(AppStorage.getInstance().getStorageFileLocation());
	}
}
```
###### src\app\util\LogHelper.java
``` java
public class LogHelper implements Observer {

	private static LogHelper logHelper;
	private Logger logger;

	/**
	 * Initializes the Logger.
	 */
	private LogHelper() {
		logger = Logger.getLogger(LogHelper.class.getName());

		update();
	}

	/**
	 * @return The LogHelper instance
	 */
	public static LogHelper getInstance() {
		if (logHelper == null) {
			logHelper = new LogHelper();
		}
		return logHelper;
	}

	/**
	 * @return The Logger instance
	 */
	public Logger getLogger() {
		return logger;
	}

	/**
	 * Updates the log file location.
	 */
	@Override
	public void update() {
		File logFile = new File(AppStorage.getInstance().getLogFileLocation());
		logFile.getParentFile().mkdirs();

		try {
			FileHandler fileHandler = new FileHandler(AppStorage.getInstance().getLogFileLocation(), true);
			SimpleFormatter formatter = new SimpleFormatter();
			fileHandler.setFormatter(formatter);

			while (logger.getHandlers().length > 0) {
				FileHandler prevFileHandler = (FileHandler)logger.getHandlers()[0];
				logger.removeHandler(prevFileHandler);
				prevFileHandler.close();
			}

			logger.addHandler(fileHandler);
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
}
```
###### src\app\util\Observer.java
``` java
public interface Observer {
	public void update();
}
```
###### src\tests\CommandTest.java
``` java
	/**
	 * Equivalence partition
	 * command content: [have task name and no parameters], [have task name and have parameters]
	 * 
	 * Boundary case
	 * command content:
	 * no task name and no parameters (invalid), have task name and no parameters (valid),
	 * have task name and have parameters (valid), no task name and have parameters (invalid)
	 * 
	 * Note: parameters include startDate, endDate and priority.
	 */
	@Test
	public void testCommandAdd() throws Exception {
		String prevStorageLocation = AppStorage.getInstance().getStorageFileLocation();
		AppStorage.getInstance().setStorageFileLocation("testStorage/testadd.txt");
		File testFile = createTestFile();

		try {
			// command content: no task name and no parameters (invalid)
			String input = "add";
			ViewState viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No task specified", viewState.getStatusMessage());

			// command content: have task name and no parameters (valid)
			input = "add add1";
			viewState = CommandController.getInstance().executeCommand(input);
			TaskList tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Added task: add1", viewState.getStatusMessage());
			assertEquals(1, tasks.getTaskList().size());
			assertEquals("add1", tasks.getTaskByIndex(0).getName());

			// command content: have task name and have parameters (valid)
			input = "add add2 priority high from 01/01/01 1pm to 02/02/02 2pm";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Added task: add2", viewState.getStatusMessage());
			assertEquals(2, tasks.getTaskList().size());
			assertEquals("add2", tasks.getTaskByIndex(1).getName());
			assertEquals(Priority.HIGH, tasks.getTaskByIndex(1).getPriority());
			assertEquals(LocalDateTime.of(2001, 1, 1, 13, 0), tasks.getTaskByIndex(1).getStartDate());
			assertEquals(LocalDateTime.of(2002, 2, 2, 14, 0), tasks.getTaskByIndex(1).getEndDate());

			// command content: no task name and have parameters (invalid)
			input = "add priority high from 01/01/01 1pm to 02/02/02 2pm";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No task specified", viewState.getStatusMessage());
		} catch (Exception e) {
			throw e; // JUnit will handle this and report a failed assertion
		} finally {
			removeFileAndParentsIfEmpty(testFile.toPath());
			AppStorage.getInstance().setStorageFileLocation(prevStorageLocation);
		}
	}

	/**
	 * Equivalence partition
	 * command content: [single id], [multiple id], [duplicate id]
	 * id: [1 .. display.getTaskList().size()]
	 * 
	 * Boundary case
	 * command content:
	 * no id (invalid), single id (valid), multiple id (valid), duplicate id (valid), any other String (invalid)
	 * 
	 * id:
	 * 0 (invalid), 1 (valid), display.getTaskList().size() (valid), display.getTaskList().size() + 1 (invalid)
	 */
	@Test
	public void testCommandDelete() throws Exception {
		String prevStorageLocation = AppStorage.getInstance().getStorageFileLocation();
		AppStorage.getInstance().setStorageFileLocation("testStorage/testdelete.txt");
		File testFile = createTestFile();
		try {
			// populate tasklist
			TaskList master = CommandController.getInstance().getMasterTaskList();
			TaskList display = CommandController.getInstance().getCurrentViewState().getTaskList();
			ArrayList<Task> testTasks = new ArrayList<Task>();
			for (int i = 0; i < 5; i++) {
				Task task = new Task(CommandController.getInstance().createCommand("add delete" + (i + 1)));
				testTasks.add(task);
				master.addTask(task);
				display.addTask(task);
			}
			TaskStorage.getInstance().writeTasks(master);
			
			// command content: no id (invalid)
			String input = "delete";
			ViewState viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No task specified", viewState.getStatusMessage());

			// command content: single id (valid)
			// id: 0 (invalid)
			input = "delete 0";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Invalid task ID entered", viewState.getStatusMessage());

			// command content: single id (valid)
			// id: display.getTaskList().size() + 1 [6] (invalid)
			input = "delete 6";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Invalid task ID entered", viewState.getStatusMessage());

			// command content: single id (valid)
			// id: 1 (valid)
			input = "delete 1";
			viewState = CommandController.getInstance().executeCommand(input);
			TaskList tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Deleted task: 1", viewState.getStatusMessage());
			assertEquals(4, tasks.getTaskList().size());
			assertEquals(null, tasks.getTaskIndexByUuid(testTasks.remove(0).getId()));

			// command content: single id (valid)
			// id: display.getTaskList().size() [4] (valid)
			input = "delete 4";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Deleted task: 4", viewState.getStatusMessage());
			assertEquals(3, tasks.getTaskList().size());
			assertEquals(null, tasks.getTaskIndexByUuid(testTasks.remove(3).getId()));

			// command content: any other String (invalid)
			// id: any valid value
			input = "delete abc";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Invalid task ID entered", viewState.getStatusMessage());

			// command content: multiple id (valid)
			// id: any valid value
			input = "delete 1 3";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Deleted task: 1, 3", viewState.getStatusMessage());
			assertEquals(1, tasks.getTaskList().size());
			assertEquals(null, tasks.getTaskIndexByUuid(testTasks.remove(2).getId()));
			assertEquals(null, tasks.getTaskIndexByUuid(testTasks.remove(0).getId()));

			// command content: duplicate id (valid)
			// id: any valid value
			input = "delete 1 1";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Deleted task: 1", viewState.getStatusMessage());
			assertEquals(0, tasks.getTaskList().size());
			assertEquals(null, tasks.getTaskIndexByUuid(testTasks.remove(0).getId()));
		} catch (Exception e) {
			throw e; // JUnit will handle this and report a failed assertion
		} finally {
			removeFileAndParentsIfEmpty(testFile.toPath());
			AppStorage.getInstance().setStorageFileLocation(prevStorageLocation);
		}
	}

	/**
	 * Equivalence partition
	 * command content: [""], ["all"], ["completed"], ["uncompleted"]
	 * 
	 * Boundary case
	 * command content:
	 * "" (valid), "all" (valid), "completed" (valid), "uncompleted" (valid), any other String (invalid)
	 */
	@Test
	public void testCommandDisplay() throws Exception {
		String prevStorageLocation = AppStorage.getInstance().getStorageFileLocation();
		AppStorage.getInstance().setStorageFileLocation("testStorage/testdisplay.txt");
		File testFile = createTestFile();

		try {
			// populate tasklist
			TaskList master = CommandController.getInstance().getMasterTaskList();
			Task task = new Task(CommandController.getInstance().createCommand("add completed task"));
			master.addTask(task);
			task = new Task(CommandController.getInstance().createCommand("add uncompleted task"));
			master.addTask(task);
			master.markTaskByIndex(0);

			// command content: "" (valid)
			String input = "display";
			ViewState viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Displaying UNCOMPLETED tasks", viewState.getStatusMessage());
			assertEquals("Displaying UNCOMPLETED tasks", viewState.getHeader());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("uncompleted task", viewState.getTaskList().getTaskByIndex(0).getName());

			// command content: "all" (valid)
			input = "display all";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Displaying ALL tasks", viewState.getStatusMessage());
			assertEquals("Displaying ALL tasks", viewState.getHeader());
			assertEquals(2, viewState.getTaskList().getTaskList().size());
			assertEquals("completed task", viewState.getTaskList().getTaskByIndex(0).getName());
			assertEquals("uncompleted task", viewState.getTaskList().getTaskByIndex(1).getName());
			
			// command content: "completed" (valid)
			input = "display completed";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Displaying COMPLETED tasks", viewState.getStatusMessage());
			assertEquals("Displaying COMPLETED tasks", viewState.getHeader());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("completed task", viewState.getTaskList().getTaskByIndex(0).getName());
			
			// command content: "uncompleted" (valid)
			input = "display uncompleted";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Displaying UNCOMPLETED tasks", viewState.getStatusMessage());
			assertEquals("Displaying UNCOMPLETED tasks", viewState.getHeader());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("uncompleted task", viewState.getTaskList().getTaskByIndex(0).getName());
			
			// command content: any other String (invalid)
			input = "display abc";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Invalid option. Available: all, completed, uncompleted (default)", viewState.getStatusMessage());
		} catch (Exception e) {
			throw e; // JUnit will handle this and report a failed assertion
		} finally {
			removeFileAndParentsIfEmpty(testFile.toPath());
			AppStorage.getInstance().setStorageFileLocation(prevStorageLocation);
		}
	}

```
###### src\tests\CommandTest.java
``` java
	/**
	 * Equivalence partition
	 * command content: [have id and have parameters with changes]
	 * id: [1 .. display.getTaskList().size()]
	 * date: ["none"], [valid date from DateParser]
	 * priority: ["none"], [valid priority from CommandParser]
	 * 
	 * Boundary case
	 * command content:
	 * no id and no parameters (invalid), no id and have parameters (invalid),
	 * have id and no parameters (invalid), have id and have parameters without changes (invalid),
	 * have id and have parameters with changes (valid)
	 * 
	 * id:
	 * 0 (invalid), 1 (valid), display.getTaskList().size() (valid), display.getTaskList().size() + 1 (invalid)
	 * 
	 * date:
	 * "none" (valid), valid values from DateParser (valid)
	 * 
	 * priority:
	 * "none" (valid), valid values from CommandParser (valid)
	 * 
	 * Note: parameters include name, startDate, endDate and priority. Invalid values for
	 * date and priority are tested in DateParserTest and CommandParserTest respectively.
	 */
	@Test
	public void testCommandEdit() throws Exception {
		String prevStorageLocation = AppStorage.getInstance().getStorageFileLocation();
		AppStorage.getInstance().setStorageFileLocation("testStorage/testedit.txt");
		File testFile = createTestFile();

		try {
			// populate tasklist
			TaskList master = CommandController.getInstance().getMasterTaskList();
			TaskList display = CommandController.getInstance().getCurrentViewState().getTaskList();
			ArrayList<Task> testTasks = new ArrayList<Task>();
			for (int i = 0; i < 3; i++) {
				Task task = new Task(CommandController.getInstance().createCommand("add edit" + (i + 1)));
				testTasks.add(task);
				master.addTask(task);
				display.addTask(task);
			}
			TaskStorage.getInstance().writeTasks(master);

			// command content: no id and no parameters (invalid)
			String input = "edit";
			ViewState viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No task specified to edit", viewState.getStatusMessage());

			// command content: no id and have parameters (invalid)
			input = "edit priority high";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No task specified to edit", viewState.getStatusMessage());

			// command content: have id and have parameters with changes (valid)
			// id: 0 (invalid)
			// changes to name
			input = "edit 0 edited0";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Invalid task ID entered", viewState.getStatusMessage());

			// command content: have id and have parameters with changes (valid)
			// id: 4 (invalid)
			// changes to name
			input = "edit 4 edited4";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Invalid task ID entered", viewState.getStatusMessage());

			// command content: have id and have parameters with changes (valid)
			// id: 1 (valid)
			// changes to name
			input = "edit 1 edited1";
			viewState = CommandController.getInstance().executeCommand(input);
			TaskList tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Edited task: edited1", viewState.getStatusMessage());
			assertEquals("edited1", tasks.getTaskByIndex(0).getName());

			// command content: have id and have parameters with changes (valid)
			// id: display.getTaskList().size() [3] (valid)
			// changes to name
			input = "edit 3 edited3";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Edited task: edited3", viewState.getStatusMessage());
			assertEquals("edited3", tasks.getTaskByIndex(0).getName());
			
			// command content: have id and have parameters without changes (invalid)
			// id: any valid values
			// no changes to name
			input = "edit 3 edited3";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No changes made for task 3", viewState.getStatusMessage());
			
			// command content: have id and have parameters with changes (valid)
			// id: any valid values
			// date: valid values from DateParser
			// changes to startDate and endDate
			input = "edit 3 from 01/01/01 1pm to 03/03/03 3pm";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Edited task: edited3", viewState.getStatusMessage());
			assertEquals(LocalDateTime.of(2001, 1, 1, 13, 0), tasks.getTaskByIndex(0).getStartDate());
			assertEquals(LocalDateTime.of(2003, 3, 3, 15, 0), tasks.getTaskByIndex(0).getEndDate());

			// command content: have id and have parameters without changes (invalid)
			// id: any valid values
			// date: valid values from DateParser
			// no changes to startDate and endDate
			input = "edit 3 from 01/01/01 1pm to 03/03/03 3pm";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("No changes made for task 3", viewState.getStatusMessage());

			// command content: have id and have parameters with changes (valid)
			// id: any valid values
			// date: valid values from DateParser
			// changes to startDate
			input = "edit 3 by 03/03/03 3pm";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Edited task: edited3", viewState.getStatusMessage());
			assertEquals(null, tasks.getTaskByIndex(0).getStartDate());

			// command content: have id and have parameters with changes (valid)
			// id: any valid values
			// date: valid values from DateParser
			// changes to endDate
			input = "edit 3 by 02/02/02 2pm";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Edited task: edited3", viewState.getStatusMessage());
			assertEquals(LocalDateTime.of(2002, 2, 2, 14, 0), tasks.getTaskByIndex(0).getEndDate());

			// command content: have id and have parameters with changes (valid)
			// id: any valid values
			// date: "none"
			// changes to dates
			input = "edit 3 date none";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Edited task: edited3", viewState.getStatusMessage());
			assertEquals(null, tasks.getTaskByIndex(0).getEndDate());

			// command content: have id and have parameters without changes (invalid)
			// id: any valid values
			// date: "none"
			// no changes to startDate and endDate
			input = "edit 3 date none";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("No changes made for task 3", viewState.getStatusMessage());

			// command content: have id and have parameters with changes (valid)
			// id: any valid values
			// priority: valid values from CommandParser
			// changes to priority
			input = "edit 1 priority high";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Edited task: edit2", viewState.getStatusMessage());
			assertEquals(Priority.HIGH, tasks.getTaskByIndex(1).getPriority());

			// command content: have id and have parameters without changes (invalid)
			// id: any valid values
			// priority: valid values from CommandParser
			// no changes to priority
			input = "edit 1 priority high";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No changes made for task 1", viewState.getStatusMessage());

			// command content: have id and have parameters with changes (valid)
			// id: any valid values
			// priority: "none"
			// changes to priority
			input = "edit 1 priority none";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Edited task: edit2", viewState.getStatusMessage());
			assertEquals(Priority.NONE, tasks.getTaskByIndex(1).getPriority());

			// command content: have id and have parameters without changes (invalid)
			// id: any valid values
			// priority: "none"
			// no changes to priority
			input = "edit 1 priority none";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No changes made for task 1", viewState.getStatusMessage());

			// command content: have id and no parameters (invalid)
			// id: any valid values
			input = "edit 1";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No changes made for task 1", viewState.getStatusMessage());
		} catch (Exception e) {
			throw e; // JUnit will handle this and report a failed assertion
		} finally {
			removeFileAndParentsIfEmpty(testFile.toPath());
			AppStorage.getInstance().setStorageFileLocation(prevStorageLocation);
		}
	}
	
	/**
	 * Equivalence partition
	 * command content: [""], [invalid command]
	 * 
	 * Boundary case
	 * command content:
	 * "" (valid), invalid command (valid)
	 * 
	 * Note: These cases are considered valid because the commands are tested to see if
	 * invalid commands are passed here. Valid commands are tested in CommandTest.
	 */
	@Test
	public void testCommandInvalid() throws Exception {
		String prevStorageLocation = AppStorage.getInstance().getStorageFileLocation();
		AppStorage.getInstance().setStorageFileLocation("testStorage/testinvalid.txt");
		File testFile = createTestFile();

		try {
			// command content: "" (valid)
			ViewState currentViewState = CommandController.getInstance().getCurrentViewState();
			String input = "";
			ViewState viewState = CommandController.getInstance().executeCommand(input);
			assertEquals(viewState, currentViewState);
			
			// command content: invalid command (valid)
			input = "abc";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Invalid command: abc", viewState.getStatusMessage());
		} catch (Exception e) {
			throw e; // JUnit will handle this and report a failed assertion
		} finally {
			removeFileAndParentsIfEmpty(testFile.toPath());
			AppStorage.getInstance().setStorageFileLocation(prevStorageLocation);
		}
	}

	/**
	 * Equivalence partition
	 * command content: [single id], [multiple id], [duplicate id], ["all"]
	 * id: [1 .. display.getTaskList().size()]
	 * 
	 * Boundary case
	 * command content:
	 * no id (invalid), single id (valid), multiple id (valid), duplicate id (valid),
	 * "all" (valid), any other String (invalid)
	 * 
	 * id:
	 * 0 (invalid), 1 (valid), display.getTaskList().size() (valid), display.getTaskList().size() + 1 (invalid)
	 */
	@Test
	public void testCommandMark() throws Exception {
		String prevStorageLocation = AppStorage.getInstance().getStorageFileLocation();
		AppStorage.getInstance().setStorageFileLocation("testStorage/testMark.txt");
		File testFile = createTestFile();
		
		try {
			// populate tasklist
			TaskList master = CommandController.getInstance().getMasterTaskList();
			TaskList display = CommandController.getInstance().getCurrentViewState().getTaskList();
			ArrayList<Task> testTasks = new ArrayList<Task>();
			for (int i = 0; i < 3; i++) {
				Task task = new Task(CommandController.getInstance().createCommand("add mark" + (i + 1)));
				testTasks.add(task);
				master.addTask(task);
				display.addTask(task);
			}
			TaskStorage.getInstance().writeTasks(master);
			
			// command content: no id (invalid)
			String input = "mark";
			ViewState viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No task specified to mark", viewState.getStatusMessage());

			// command content: single id (valid)
			// id: 0 (invalid)
			input = "mark 0";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Invalid task ID entered", viewState.getStatusMessage());

			// command content: single id (valid)
			// id: display.getTaskList().size() + 1 [4] (invalid)
			input = "mark 4";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Invalid task ID entered", viewState.getStatusMessage());

			// command content: single id (valid)
			// id: 1 (valid)
			input = "mark 1";
			viewState = CommandController.getInstance().executeCommand(input);
			TaskList tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Marked task completed: 1", viewState.getStatusMessage());
			assertTrue(tasks.getTaskByIndex(0).isCompleted());

			// command content: single id (valid)
			// id: display.getTaskList().size() [3] (valid)
			input = "mark 3";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Marked task completed: 3", viewState.getStatusMessage());
			assertTrue(tasks.getTaskByIndex(2).isCompleted());

			// command content: duplicate id (valid)
			// id: any valid value
			input = "mark 1 1";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Marked task uncompleted: 1", viewState.getStatusMessage());
			assertFalse(tasks.getTaskByIndex(0).isCompleted());

			// command content: multiple id (valid)
			// id: any valid value
			input = "mark 1 3";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Marked task completed: 1; Marked task uncompleted: 3", viewState.getStatusMessage());
			assertTrue(tasks.getTaskByIndex(0).isCompleted());
			assertFalse(tasks.getTaskByIndex(2).isCompleted());

			// command content: "all" (valid)
			// id: any valid value
			input = "mark all";
			viewState = CommandController.getInstance().executeCommand(input);
			tasks = TaskStorage.getInstance().readTasks();
			assertEquals("Marked tasks completed: 2, 3; Marked task uncompleted: 1", viewState.getStatusMessage());
			assertFalse(tasks.getTaskByIndex(0).isCompleted());
			assertTrue(tasks.getTaskByIndex(1).isCompleted());
			assertTrue(tasks.getTaskByIndex(2).isCompleted());

			// command content: any other String (invalid)
			// id: any valid value
			input = "mark abc";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Invalid task ID entered", viewState.getStatusMessage());
		} catch (Exception e) {
			throw e; // JUnit will handle this and report a failed assertion
		} finally {
			removeFileAndParentsIfEmpty(testFile.toPath());
			AppStorage.getInstance().setStorageFileLocation(prevStorageLocation);
		}
	}

	/**
	 * Equivalence partition
	 * command content: [no log keyword and have location with changes], [have log keyword and have location with changes]
	 * location: ["default"], [valid location]
	 * file: [does not exist]
	 * 
	 * Boundary case
	 * command content:
	 * no log keyword and no location (invalid), have log keyword and no location (invalid),
	 * no log keyword and have location without changes (invalid),
	 * have log keyword and have location without changes (invalid),
	 * no log keyword and have location with changes (valid), have log keyword and have location with changes (valid),
	 * 
	 * location:
	 * "default" (valid), valid location (valid), valid location with spaces (valid)
	 * 
	 * file:
	 * exist (invalid), does not exist (valid)
	 */
	@Test
	public void testCommandSave() {
		try {
			String userStorageFileLocation = AppStorage.getInstance().getStorageFileLocation();
			String userLogFileLocation = AppStorage.getInstance().getLogFileLocation();

			String prevStorageFileLocation = userStorageFileLocation;
			String prevLogFileLocation = userLogFileLocation;
			File prevStorageFile = new File(prevStorageFileLocation);
			File prevLogFile = new File(prevLogFileLocation);
			List<String> prevStorageFileLines = Files.readAllLines(prevStorageFile.toPath());

			// command content: no log keyword and no location (invalid)
			String input = "save";
			ViewState viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No storage file location specified", viewState.getStatusMessage());

			// command content: have log keyword and no location (invalid)
			input = "save log";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No log file location specified", viewState.getStatusMessage());

			// command content: no log keyword and have location without changes (invalid)
			input = "save " + prevStorageFileLocation;
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Same storage file location. No changes to storage file location: "
						 + prevStorageFileLocation, viewState.getStatusMessage());
			assertEquals(prevStorageFileLocation, AppStorage.getInstance().getStorageFileLocation());

			// command content: have log keyword and have location without changes (invalid)
			input = "save log " + prevLogFileLocation;
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Same log file location. No changes to log file location: "
						 + prevLogFileLocation, viewState.getStatusMessage());
			assertEquals(prevStorageFileLocation, AppStorage.getInstance().getStorageFileLocation());

			// command content: no log keyword and have location with changes (valid)
			// location: valid location (valid)
			// file: does not exist (valid)
			input = "save testsave/storage";
			viewState = CommandController.getInstance().executeCommand(input);
			File currStorageFile = new File(AppStorage.getInstance().getStorageFileLocation());
			String parentLocation = AppStorage.getInstance().toAcceptableCanonicalPath(prevStorageFile.getParent());
			assertEquals("Saved storage file location: " + parentLocation + "/testsave/storage",
						 viewState.getStatusMessage());
			assertEquals(parentLocation + "/testsave/storage", AppStorage.getInstance().getStorageFileLocation());
			assertEquals(prevStorageFileLines, Files.readAllLines(currStorageFile.toPath()));
			assertFalse(prevStorageFile.exists());
			assertFalse(prevStorageFile.equals(currStorageFile));

			prevStorageFileLocation = AppStorage.getInstance().getStorageFileLocation();
			prevStorageFile = new File(prevStorageFileLocation);

			// command content: have log keyword and have location with changes (valid)
			// location: valid location (valid)
			// file: does not exist (valid)
			List<String> prevLogFileLines = Files.readAllLines(prevLogFile.toPath());
			input = "save log testsave/log";
			viewState = CommandController.getInstance().executeCommand(input);
			File currLogFile = new File(AppStorage.getInstance().getLogFileLocation());
			List<String> currLogFileLines = Files.readAllLines(currLogFile.toPath());
			for (int i = currLogFileLines.size(); i > prevLogFileLines.size(); i--) {
				currLogFileLines.remove(i - 1);
			}
			parentLocation = AppStorage.getInstance().toAcceptableCanonicalPath(prevLogFile.getParentFile().getParent());
			assertEquals("Saved log file location: " + parentLocation + "/testsave/log", viewState.getStatusMessage());
			assertEquals(parentLocation + "/testsave/log", AppStorage.getInstance().getLogFileLocation());
			assertEquals(prevLogFileLines, currLogFileLines);
			assertFalse(prevLogFile.exists());
			assertFalse(prevLogFile.equals(currLogFile));

			prevLogFileLocation = AppStorage.getInstance().getLogFileLocation();
			prevLogFile = new File(prevLogFileLocation);

			// command content: no log keyword and have location with changes (valid)
			// location: valid location with spaces (valid)
			// file: does not exist (valid)
			input = "save test  save  /  storage  test";
			viewState = CommandController.getInstance().executeCommand(input);
			currStorageFile = new File(AppStorage.getInstance().getStorageFileLocation());
			parentLocation = AppStorage.getInstance().toAcceptableCanonicalPath(prevStorageFile.getParentFile().getParent());
			assertEquals("Saved storage file location: " + parentLocation + "/test  save/storage  test",
					viewState.getStatusMessage());
			assertEquals(parentLocation + "/test  save/storage  test",
					AppStorage.getInstance().getStorageFileLocation());
			assertEquals(prevStorageFileLines, Files.readAllLines(currStorageFile.toPath()));
			assertFalse(prevStorageFile.exists());
			assertFalse(prevStorageFile.equals(currStorageFile));

			prevStorageFileLocation = AppStorage.getInstance().getStorageFileLocation();
			prevStorageFile = new File(prevStorageFileLocation);

			// command content: have log keyword and have location with changes (valid)
			// location: valid location with spaces (valid)
			// file: does not exist (valid)
			prevLogFileLines = Files.readAllLines(currLogFile.toPath());
			input = "save log test  save  /  log  test";
			viewState = CommandController.getInstance().executeCommand(input);
			currLogFile = new File(AppStorage.getInstance().getLogFileLocation());
			currLogFileLines = Files.readAllLines(currLogFile.toPath());
			for (int i = currLogFileLines.size(); i > prevLogFileLines.size(); i--) {
				currLogFileLines.remove(i - 1);
			}
			parentLocation = AppStorage.getInstance().toAcceptableCanonicalPath(prevLogFile.getParentFile().getParent());
			assertEquals("Saved log file location: " + parentLocation + "/test  save/log  test",
					viewState.getStatusMessage());
			assertEquals(parentLocation + "/test  save/log  test", AppStorage.getInstance().getLogFileLocation());
			assertEquals(prevLogFileLines, currLogFileLines);
			assertFalse(prevLogFile.exists());
			assertFalse(prevLogFile.equals(currLogFile));

			prevLogFileLocation = AppStorage.getInstance().getLogFileLocation();
			prevLogFile = new File(prevLogFileLocation);

			// command content: no log keyword and have location with changes (valid)
			// location: "default" (valid)
			// file: does not exist (valid)
			input = "save default";
			viewState = CommandController.getInstance().executeCommand(input);
			currStorageFile = new File(AppStorage.getInstance().getStorageFileLocation());
			parentLocation = AppStorage.getInstance().toAcceptableCanonicalPath(".");
			assertEquals("Saved storage file location: " + parentLocation + "/next.txt", viewState.getStatusMessage());
			assertEquals(parentLocation + "/next.txt", AppStorage.getInstance().getStorageFileLocation());
			assertEquals(prevStorageFileLines, Files.readAllLines(currStorageFile.toPath()));
			assertFalse(prevStorageFile.exists());
			assertFalse(prevStorageFile.equals(currStorageFile));

			prevStorageFileLocation = AppStorage.getInstance().getStorageFileLocation();
			prevStorageFile = new File(prevStorageFileLocation);

			// command content: have log keyword and have location with changes (valid)
			// location: "default" (valid)
			// file: does not exist (valid)
			prevLogFileLines = Files.readAllLines(currLogFile.toPath());
			input = "save log default";
			viewState = CommandController.getInstance().executeCommand(input);
			currLogFile = new File(AppStorage.getInstance().getLogFileLocation());
			currLogFileLines = Files.readAllLines(currLogFile.toPath());
			for (int i = currLogFileLines.size(); i > prevLogFileLines.size(); i--) {
				currLogFileLines.remove(i - 1);
			}
			parentLocation = AppStorage.getInstance().toAcceptableCanonicalPath(".");
			assertEquals("Saved log file location: " + parentLocation + "/logs/next.log", viewState.getStatusMessage());
			assertEquals(parentLocation + "/logs/next.log", AppStorage.getInstance().getLogFileLocation());
			assertEquals(prevLogFileLines, currLogFileLines);
			assertFalse(prevLogFile.exists());
			assertFalse(prevLogFile.equals(currLogFile));

			prevLogFileLocation = AppStorage.getInstance().getLogFileLocation();
			prevLogFile = new File(prevLogFileLocation);

			// command content: no log keyword and have location without changes (invalid)
			// location: "default" (valid)
			// file: does not exist (valid)
			input = "save default";
			viewState = CommandController.getInstance().executeCommand(input);
			currStorageFile = new File(AppStorage.getInstance().getStorageFileLocation());
			assertEquals("Same storage file location. No changes to storage file location: " + prevStorageFileLocation,
					viewState.getStatusMessage());
			assertEquals(prevStorageFileLocation, AppStorage.getInstance().getStorageFileLocation());

			// command content: have log keyword and have location without changes (invalid)
			// location: "default" (valid)
			// file: does not exist (valid)
			prevLogFileLines = Files.readAllLines(currLogFile.toPath());
			input = "save log default";
			viewState = CommandController.getInstance().executeCommand(input);
			currLogFile = new File(AppStorage.getInstance().getLogFileLocation());
			currLogFileLines = Files.readAllLines(currLogFile.toPath());
			for (int i = currLogFileLines.size(); i > prevLogFileLines.size(); i--) {
				currLogFileLines.remove(i - 1);
			}
			assertEquals("Same log file location. No changes to log file location: " + prevLogFileLocation,
					viewState.getStatusMessage());
			assertEquals(prevLogFileLocation, AppStorage.getInstance().getLogFileLocation());

			File testFile = new File("test");
			if (!testFile.exists()) {
				testFile.createNewFile();
			}

			// command content: no log keyword and have location with changes (valid)
			// location: any valid values
			// file: exist (invalid)
			input = "save test";
			viewState = CommandController.getInstance().executeCommand(input);
			currStorageFile = new File(AppStorage.getInstance().getStorageFileLocation());
			assertEquals("File already exists in specified location: test", viewState.getStatusMessage());
			assertEquals(prevStorageFileLocation, AppStorage.getInstance().getStorageFileLocation());

			// command content: have log keyword and have location with changes (valid)
			// location: any valid values
			// file: exist (invalid)
			input = "save log test";
			viewState = CommandController.getInstance().executeCommand(input);
			currLogFile = new File(AppStorage.getInstance().getLogFileLocation());
			assertEquals("File already exists in specified location: test", viewState.getStatusMessage());
			assertEquals(prevLogFileLocation, AppStorage.getInstance().getLogFileLocation());

			Files.delete(testFile.toPath());

			input = "save " + userStorageFileLocation;
			viewState = CommandController.getInstance().executeCommand(input);

			input = "save log " + userLogFileLocation;
			viewState = CommandController.getInstance().executeCommand(input);
		} catch (IOException e) {
			System.out.println(e.getMessage());
		}
	}

	/**
	 * Equivalence partition
	 * command content: [have parameters]
	 * 
	 * Boundary case
	 * command content:
	 * no parameters (valid), have parameters (valid)
	 * 
	 * name:
	 * whole word match (valid), partial word match (valid),
	 * multiple whole word match (valid), multiple partial word match (invalid)
	 * partial and whole word match (invalid), whole and partial word match (valid)
	 * 
	 * date:
	 * "date none" (valid), "between [startDate] and [endDate]" (valid),
	 * "after [date]" (valid), "before [date]" (valid)
	 * 
	 * priority:
	 * "none" (valid), valid values from CommandParser (valid)
	 * 
	 * Note: parameters include name, startDate, endDate, priority and type. Invalid
	 * values for date and priority are tested in DateParserTest, CommandParserTest and PredicatesTest.
	 */
	@Test
	public void testCommandSearch() throws Exception {
		String prevStorageLocation = AppStorage.getInstance().getStorageFileLocation();
		AppStorage.getInstance().setStorageFileLocation("testStorage/testsearch.txt");
		File testFile = createTestFile();
		
		try {
			// populate tasklist
			TaskList master = CommandController.getInstance().getMasterTaskList();
			TaskList display = CommandController.getInstance().getCurrentViewState().getTaskList();
			ArrayList<Task> testTasks = new ArrayList<Task>();
			Task task = new Task(CommandController.getInstance().createCommand("add CS2103 tutorial"));
			task.setStartDate(LocalDateTime.of(2001, 1, 1, 13, 0));
			task.setEndDate(LocalDateTime.of(2003, 3, 3, 15, 0));
			task.setPriority(Priority.HIGH);
			testTasks.add(task);
			master.addTask(task);
			display.addTask(task);
			task = new Task(CommandController.getInstance().createCommand("add CS2103 lecture"));
			task.setEndDate(LocalDateTime.of(2002, 2, 2, 14, 0));
			testTasks.add(task);
			master.addTask(task);
			display.addTask(task);
			task = new Task(CommandController.getInstance().createCommand("add CS2010 lecture"));
			task.setCompleted(true);
			testTasks.add(task);
			master.addTask(task);
			display.addTask(task);
			TaskStorage.getInstance().writeTasks(master);

			// command content: no parameters (invalid)
			String input = "search";
			ViewState viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("No search parameters specified", viewState.getStatusMessage());
			assertEquals(3, viewState.getTaskList().getTaskList().size());

			// command content: have parameters (valid)
			// name: whole word match (valid)
			input = "search lecture";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("1 match(es)", viewState.getStatusMessage());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2103 lecture", viewState.getTaskList().getTaskByIndex(0).getName());

			// command content: have parameters (valid)
			// name: partial word match (valid)
			input = "search cs";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("2 match(es)", viewState.getStatusMessage());
			assertEquals(2, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2103 tutorial", viewState.getTaskList().getTaskByIndex(0).getName());
			assertEquals("CS2103 lecture", viewState.getTaskList().getTaskByIndex(1).getName());

			// command content: have parameters (valid)
			// name: multiple whole word match (valid)
			input = "search cs2103 tutorial";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("1 match(es)", viewState.getStatusMessage());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2103 tutorial", viewState.getTaskList().getTaskByIndex(0).getName());

			// command content: have parameters (valid)
			// name: multiple partial word match (invalid)
			input = "search cs tut";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("0 match(es)", viewState.getStatusMessage());
			assertEquals(0, viewState.getTaskList().getTaskList().size());

			// command content: have parameters (valid)
			// name: partial and whole word match (invalid)
			input = "search cs tutorial";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("0 match(es)", viewState.getStatusMessage());
			assertEquals(0, viewState.getTaskList().getTaskList().size());

			// command content: have parameters (valid)
			// name: whole and partial word match (valid)
			input = "search cs2103 tut";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("1 match(es)", viewState.getStatusMessage());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2103 tutorial", viewState.getTaskList().getTaskByIndex(0).getName());

			// command content: have parameters (valid)
			// date: "between [startDate] and [endDate]" (valid)
			input = "search between 01/01/01 and 03/03/03";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("2 match(es)", viewState.getStatusMessage());
			assertEquals(2, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2103 tutorial", viewState.getTaskList().getTaskByIndex(0).getName());
			assertEquals("CS2103 lecture", viewState.getTaskList().getTaskByIndex(1).getName());

			// command content: have parameters (valid)
			// date: "after [date]" (valid)
			input = "search after 02/02/02";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("2 match(es)", viewState.getStatusMessage());
			assertEquals(2, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2103 tutorial", viewState.getTaskList().getTaskByIndex(0).getName());
			assertEquals("CS2103 lecture", viewState.getTaskList().getTaskByIndex(1).getName());

			// command content: have parameters (valid)
			// date: "before [date]" (valid)
			input = "search before 02/02/02";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("1 match(es)", viewState.getStatusMessage());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2103 lecture", viewState.getTaskList().getTaskByIndex(0).getName());

			// command content: have parameters (valid)
			// priority: "none" (valid)
			input = "search priority none";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("1 match(es)", viewState.getStatusMessage());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2103 lecture", viewState.getTaskList().getTaskByIndex(0).getName());

			// command content: have parameters (valid)
			// priority: valid values from CommandParser (valid)
			input = "search priority high";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("1 match(es)", viewState.getStatusMessage());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2103 tutorial", viewState.getTaskList().getTaskByIndex(0).getName());

			// command content: have parameters (valid)
			// type
			input = "search type completed";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("1 match(es)", viewState.getStatusMessage());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2010 lecture", viewState.getTaskList().getTaskByIndex(0).getName());

			// command content: have parameters (valid)
			// date: "date none" (valid)
			input = "search date none type completed";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("1 match(es)", viewState.getStatusMessage());
			assertEquals(1, viewState.getTaskList().getTaskList().size());
			assertEquals("CS2010 lecture", viewState.getTaskList().getTaskByIndex(0).getName());
		} catch (Exception e) {
			throw e; // JUnit will handle this and report a failed assertion
		} finally {
			removeFileAndParentsIfEmpty(testFile.toPath());
			AppStorage.getInstance().setStorageFileLocation(prevStorageLocation);
		}
	}

	/**
	 * Equivalence partition
	 * command content: ["light"], ["dark"]
	 * 
	 * Boundary case
	 * command content:
	 * "" (invalid), "light" (valid), "dark" (valid), any other String (invalid)
	 */
	@Test
	public void testCommandTheme() throws Exception {
		String prevSelectedTheme = AppStorage.getInstance().getSelectedTheme();

		try {
			// command content: "" (invalid)
			String input = "theme";
			ViewState viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Available themes: light, dark", viewState.getStatusMessage());

			// command content: "light" (valid)
			input = "theme light";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Current theme: light", viewState.getStatusMessage());
			assertTrue("light", viewState.getTheme().endsWith("theme_light.css"));
			assertEquals("light", AppStorage.getInstance().getSelectedTheme());

			// command content: "dark" (valid)
			input = "theme dark";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Current theme: dark", viewState.getStatusMessage());
			assertTrue("dark", viewState.getTheme().endsWith("theme_dark.css"));
			assertEquals("dark", AppStorage.getInstance().getSelectedTheme());

			// command content: any other String (invalid)
			input = "theme abc";
			viewState = CommandController.getInstance().executeCommand(input);
			assertEquals("Available themes: light, dark", viewState.getStatusMessage());
		} catch (Exception e) {
			throw e; // JUnit will handle this and report a failed assertion
		} finally {
			AppStorage.getInstance().setSelectedTheme(prevSelectedTheme);
		}
	}

	/**
	 * Create the test file. Only use when storage file location of the configuration
	 * file is changed to the test file location.
	 * 
	 * @return	Test file.
	 */
	private File createTestFile() {
		File testFile = new File(AppStorage.getInstance().getStorageFileLocation());
		
		if (!testFile.exists()) {
			if (testFile.getParentFile() != null) {
				testFile.getParentFile().mkdirs();
			}

			try {
				testFile.createNewFile();
			} catch (IOException e) {
				e.printStackTrace();
			}

			TaskStorage.getInstance().writeTasks(new TaskList());
		}

		return testFile;
	}

	/**
	 * Removes specified file if exist and empty parent directories.
	 *  
	 * @param path			Path of specified file.
	 * @throws IOException
	 */
```
###### src\tests\integration\IntegrationTest.java
``` java
	/**
	 * Create the test file. Only use when storage file location of the configuration
	 * file is changed to the test file location.
	 * 
	 * @return	Test file.
	 */
	private File createTestFile() {
		File testFile = new File(AppStorage.getInstance().getStorageFileLocation());
		
		if (!testFile.exists()) {
			if (testFile.getParentFile() != null) {
				testFile.getParentFile().mkdirs();
			}

			try {
				testFile.createNewFile();
			} catch (IOException e) {
				e.printStackTrace();
			}

			TaskStorage.getInstance().writeTasks(new TaskList());
		}

		return testFile;
	}

	/**
	 * Removes specified file if exist and empty parent directories.
	 *  
	 * @param path			Path of specified file.
	 * @throws IOException
	 */
```
###### src\tests\StorageTest.java
``` java
	@Test
	public void testStorage() throws Exception {
		String userStorageFileLocation = AppStorage.getInstance().getStorageFileLocation();
		String userLogFileLocation = AppStorage.getInstance().getLogFileLocation();
		String userSelectedTheme = AppStorage.getInstance().getSelectedTheme();

		/* AppStorage */
		// set properties
		AppStorage.getInstance().setStorageFileLocation("testStorage/next.txt");
		AppStorage.getInstance().setLogFileLocation("testLog/next.log");
		AppStorage.getInstance().setSelectedTheme("dark");

		// get properties
		String currentDirectoryLocation = AppStorage.getInstance().toAcceptableCanonicalPath(new File(".").getCanonicalPath());
		assertEquals(currentDirectoryLocation + "/testStorage/next.txt",
				AppStorage.getInstance().getStorageFileLocation());
		assertEquals(currentDirectoryLocation+ "/testLog/next.log",
				AppStorage.getInstance().getLogFileLocation());
		assertEquals("dark", AppStorage.getInstance().getSelectedTheme());

		File testFile = createTestFile();
		
		try {
			/* TaskStorage */
			/* empty tasklist */
			// writing
			TaskList writeList = new TaskList();
			TaskStorage.getInstance().writeTasks(writeList);

			// reading
			TaskList readList = TaskStorage.getInstance().readTasks();
			assertTrue(readList.getTaskList().isEmpty());

			/* populated tasklist */
			// writing
			String input = "add buy milk due 15/11/15 0959";
			Command cmd = CommandController.getInstance().createCommand(input);
			Task task = new Task(cmd);
			writeList.addTask(task);

			input = "add priority high from 3pm to 5pm";
			cmd = CommandController.getInstance().createCommand(input);
			task = new Task(cmd);
			writeList.addTask(task);

			TaskStorage.getInstance().writeTasks(writeList);

			// reading
			readList = TaskStorage.getInstance().readTasks();
			assertEquals(2, readList.getTaskList().size());
			assertEquals("buy milk", readList.getTaskList().get(0).getName());
			assertEquals("", readList.getTaskList().get(1).getName());
		} catch (Exception e) {
			throw e; // JUnit will handle this and report a failed assertion
		} finally {
			removeFileAndParentsIfEmpty(testFile.toPath());
			AppStorage.getInstance().setStorageFileLocation(userStorageFileLocation);
		}

		// default properties
		AppStorage.getInstance().setToDefaultStorageFileLocation();;
		AppStorage.getInstance().setToDefaultLogFileLocation();
		AppStorage.getInstance().setToDefaultSelectedTheme();
		assertEquals(currentDirectoryLocation + "/next.txt",
				AppStorage.getInstance().getStorageFileLocation());
		assertEquals(currentDirectoryLocation + "/logs/next.log",
				AppStorage.getInstance().getLogFileLocation());
		assertEquals("light", AppStorage.getInstance().getSelectedTheme());

		AppStorage.getInstance().setStorageFileLocation(userStorageFileLocation);
		AppStorage.getInstance().setLogFileLocation(userLogFileLocation);
		AppStorage.getInstance().setSelectedTheme(userSelectedTheme);
		
		removeFileAndParentsIfEmpty(new File(currentDirectoryLocation + "/testLog/next.log").toPath());
	}

	private File createTestFile() {
		File testFile = new File(AppStorage.getInstance().getStorageFileLocation());
		
		if (!testFile.exists()) {
			if (testFile.getParentFile() != null) {
				testFile.getParentFile().mkdirs();
			}

			try {
				testFile.createNewFile();
			} catch (IOException e) {
				e.printStackTrace();
			}

			TaskStorage.getInstance().writeTasks(new TaskList());
		}

		return testFile;
	}

```
